# MeshLabeler 待办事项

本文档列出了项目的改进任务清单。详细的优化建议请参考 [OPTIMIZATION_SUGGESTIONS.md](./OPTIMIZATION_SUGGESTIONS.md)。

## 🚨 高优先级（必须立即处理）

- [ ] **重构架构：将 label.cpp 改为独立的 MeshLabeler 类**
  - 当前问题：`#include "label.cpp"` 违反 C++ 编译原则
  - 影响：无法测试、符号冲突、代码耦合
  - 预计时间：2-3 天

- [ ] **创建 meshlabeler.h 和 meshlabeler.cpp 文件**
  - 实现正确的类封装
  - 定义清晰的公共接口
  - 预计时间：1 天

- [ ] **将全局变量封装到 MeshLabeler 类中**
  - 移除所有全局 VTK 对象
  - 使用 RAII 管理资源
  - 预计时间：1-2 天

- [ ] **修复 BFS 递归问题：改为迭代实现**
  - 当前问题：大型网格可能栈溢出
  - 解决方案：使用 `std::queue` + 访问标记
  - 预计时间：0.5 天

- [ ] **添加文件加载错误处理和验证**
  - STL 文件加载失败提示
  - VTP 保存错误处理
  - 文件格式验证
  - 预计时间：0.5 天

---

## ⚠️ 中优先级（近期处理）

### 代码质量改进

- [ ] **提取重复的球体创建代码为独立函数**
  - 当前重复 3 次
  - 预计时间：0.5 天

- [ ] **定义常量替换魔法数字**
  - `MAX_LABELS = 20`
  - `DEFAULT_BRUSH_RADIUS = 2.5`
  - `BRUSH_RADIUS_STEP = 0.15`
  - 预计时间：0.5 天

- [ ] **添加 EditMode 枚举类替换 int 变量**
  ```cpp
  enum class EditMode { Brush, Single };
  ```
  - 预计时间：0.5 天

- [ ] **统一命名规范（成员变量使用 m_ 前缀）**
  - 预计时间：1 天

- [ ] **为所有函数和类添加 Doxygen 注释**
  - 预计时间：1 天

### 性能优化

- [ ] **优化渲染性能：添加渲染节流机制**
  - 限制渲染频率为 60fps
  - 预计时间：0.5 天

- [ ] **复用球体对象避免频繁创建销毁**
  - 当前每次鼠标移动都创建新对象
  - 预计时间：0.5 天

- [ ] **使用 vtkCellLocator 加速空间查询**
  - 预计时间：1 天

### 核心功能增强

- [ ] **实现撤销/重做功能（命令模式）**
  - 保存操作历史栈
  - Ctrl+Z / Ctrl+Y 快捷键
  - 预计时间：2-3 天

- [ ] **支持加载已标注的 VTP 文件继续编辑**
  - 使用 `vtkXMLPolyDataReader`
  - 恢复标签数据
  - 预计时间：1 天

- [ ] **实现自动保存功能**
  - 定时保存到临时文件（每 5 分钟）
  - 崩溃恢复机制
  - 预计时间：1-2 天

---

## 📝 低优先级（长期规划）

### UI/UX 增强

- [ ] **添加标签管理界面**
  - 标签颜色自定义
  - 标签名称编辑
  - 标签显示/隐藏切换
  - 预计时间：3-4 天

- [ ] **添加标签统计功能**
  - 显示每个标签的面片数量
  - 百分比统计
  - 导出统计数据
  - 预计时间：1 天

- [ ] **添加视图工具**
  - 重置视角按钮
  - 正交视图（前/后/左/右/顶/底）
  - 透明度滑块
  - 线框/实体切换
  - 背景颜色选择器
  - 预计时间：2-3 天

- [ ] **添加更多文件格式支持**
  - PLY 导入/导出
  - OBJ 导入/导出
  - 预计时间：1-2 天

### 构建系统和测试

- [ ] **创建 CMakeLists.txt 支持跨平台构建**
  - 替代 .pro 文件
  - 更好的依赖管理
  - 预计时间：1 天

- [ ] **编写单元测试（使用 Google Test）**
  - 测试文件加载
  - 测试标注算法
  - 测试撤销/重做
  - 预计时间：3-5 天

- [ ] **设置 GitHub Actions CI/CD**
  - 自动构建
  - 代码质量检查（clang-tidy）
  - 自动发布
  - 预计时间：1-2 天

### 文档

- [ ] **编写用户使用文档和教程**
  - 安装指南
  - 快速入门
  - 功能详解
  - FAQ
  - 预计时间：2-3 天

- [ ] **创建开发者文档**
  - 架构设计文档
  - API 文档（Doxygen）
  - 贡献指南
  - 代码规范
  - 预计时间：2-3 天

- [ ] **录制视频教程**
  - 基本操作演示
  - 高级功能讲解
  - 预计时间：1-2 天

---

## 📊 进度追踪

### 统计
- **总任务数**: 30
- **已完成**: 0
- **进行中**: 0
- **待开始**: 30

### 里程碑

#### 🎯 里程碑 1：代码重构 (预计 2 周)
- [ ] 架构重构完成
- [ ] 全局变量消除
- [ ] BFS 算法优化
- [ ] 错误处理完善

#### 🎯 里程碑 2：核心功能 (预计 2 周)
- [ ] 撤销/重做实现
- [ ] VTP 文件加载
- [ ] 自动保存
- [ ] 性能优化

#### 🎯 里程碑 3：用户体验 (预计 3 周)
- [ ] 标签管理界面
- [ ] 视图工具
- [ ] 操作提示
- [ ] 用户文档

#### 🎯 里程碑 4：质量保证 (预计 2 周)
- [ ] 单元测试
- [ ] CI/CD
- [ ] 代码审查
- [ ] 性能测试

---

## 🔄 近期计划（本周/本月）

### 本周目标
1. 完成架构重构（MeshLabeler 类）
2. 修复 BFS 递归问题
3. 添加基本错误处理

### 本月目标
1. 完成所有高优先级任务
2. 实现撤销/重做功能
3. 支持 VTP 文件加载
4. 优化渲染性能

---

## 📝 备注

- 所有时间估计基于单人全职开发
- 优先级可根据用户反馈调整
- 建议先完成高优先级任务再进行功能扩展
- 每完成一个任务都应该进行代码审查和测试

---

**更新日期**: 2026-01-11
**维护者**: @SchwarzSolomon
